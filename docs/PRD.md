# Telegram City Quest Bot — Product Requirements Document (PRD)

## 1. Overview / Problem

Многие жители и гости Санкт-Петербурга хотят интересно провести время и узнать новые места в городе, но не всегда знают, где искать вдохновение для прогулок. Необходимо создать Telegram-бота на Python, который будет отправлять пользователю задания-головоломки по поиску интересных локаций. Пользователь отправляет свою геолокацию для проверки, проходит все этапы и открывает для себя город.

## 2. Key User Flows

- Пользователь запускает бота и получает приветствие и правила игры.
- Бот отправляет первое задание из файла routes.csv.
- Пользователь посещает предполагаемое место и отправляет свою геолокацию.
- Если локация верная (попадает в радиус 50 метров), бот отправляет следующее задание.
- Если локация неверная, бот пишет “Почти! Попробуй еще раз.”
- Процесс повторяется до прохождения всех 10 заданий.
- По завершении пользователь получает поздравление и предложение пройти квест снова.
- Бот сбрасывает прогресс пользователя, если он не активен 30 дней.
- Прогресс и история прохождения каждого пользователя записываются в файл progress.csv в GitHub-репозитории.

## 3. Functional Requirements

- Линейная последовательность из 10 заданий, каждое — текстовая загадка и геолокация (широта, долгота).
- Проверка геолокации пользователя с точностью до 50 метров.
- База заданий хранится в публичном файле routes.csv в GitHub-репозитории. Файл можно легко редактировать через GitHub Web UI.
- Прогресс и история прохождения пользователей записываются ботом в progress.csv в том же репозитории с помощью GitHub API.
- Вся бизнес-логика реализована на Python с использованием библиотеки [python-telegram-bot](https://docs.python-telegram-bot.org/).
- Дружелюбный, юмористический стиль общения.
- Нет подсказок и ограничения по времени на задания.
- Возможность проходить квест повторно.
- Сброс прогресса пользователя через 30 дней неактивности.
- Приветственное сообщение и финальное поздравление.
- Возможность выгрузки истории прохождения (при необходимости) в файл progress.csv для анализа или внешней статистики.

## 4. Non-Goals

- Нет командной игры или состязаний между пользователями.
- Нет интеграции с картой или отображения точек на карте.
- Нет платных функций или монетизации.
- Нет поддержки других мессенджеров (только Telegram).
- Нет расширенной аналитики или сложных отчётов.
- Нет самостоятельного создания заданий пользователями через интерфейс бота.
- Нет интеграции с OpenAI, Google Sheets, или другими сторонними API.

## 5. Milestones & Release Plan

- Подготовка структуры routes.csv и progress.csv в GitHub-репозитории.
- Разработка и тестирование загрузки маршрута из routes.csv (read-only).
- Разработка логики записи прогресса в progress.csv через GitHub API.
- Прототипирование и разработка основной логики бота на python-telegram-bot.
- Тестирование в боевых условиях (Telegram, корректность сценариев, отказоустойчивость).
- Доработка, финальный рефакторинг и релиз.
- Итоговый релиз MVP (минимально жизнеспособного продукта).
